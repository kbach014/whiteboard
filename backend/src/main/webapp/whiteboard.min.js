/*! Whiteboard 0.1.0 07-05-2015 */
angular.module("whiteboard",["ngRoute"]),angular.module("whiteboard").config(["$routeProvider","$httpProvider",function(a){"use strict";a.when("/whiteboard/:id",{controller:"WhiteboardCtrl",templateUrl:"partials/whiteboard.html"}),a.otherwise({redirectTo:"/whiteboard/42"})}]),angular.module("whiteboard").controller("WhiteboardCtrl",["$scope","$routeParams","whiteboardService",function(a,b,c){"use strict";b.id&&c.connect(b.id).then(function(){a.successMessage="Connection established."},function(){a.errorMessage="Unable to connect to shared whiteboard."}),a.draw=function(){c.scheduleDrawEvent({shapeUuid:"8218c5e7-a950-4ebb-bb3d-7d4987e8c51c",eventUuid:"8218c5e7-a950-4ebb-bb3d-7d4987e8c51d",shape:"RECT",type:"START",coords:"0, 0, 10, 10"})},a.dismissErrorMessage=function(){a.errorMessage=null},a.dismissSuccessMessage=function(){a.successMessage=null}}]),angular.module("whiteboard").directive("delegateFocus",[function(){"use strict";return{restrict:"A",scope:{delegateFocus:"@"},link:function(a,b,c){b.on("focus",function(){var a=angular.element("#"+c.delegateFocus);a&&a.focus()})}}}]),angular.module("whiteboard").factory("whiteboardService",["$http","$q","$interval",function(a,b,c){"use strict";var d,e=[],f=null,g=function(){if(d&&d.readyState===WebSocket.OPEN&&!_.isEmpty(e)){var a=e;e=[],d.send(JSON.stringify(a))}};return{connect:function(a){this.close();var e=b.defer();return d=new WebSocket("ws://localhost:8080/backend/drawings/"+a),d.onerror=function(){e.reject()},d.onopen=function(){d.onerror=_.noop(),f=c(g,100,!1),e.resolve()},e.promise},setErrorCallback:function(a){d.onerror=_.isFunction(a)?a:_.noop()},scheduleDrawEvent:function(a){e.push(a)},close:function(){f&&(c.cancel(f),f=null),d&&d.readyState===WebSocket.OPEN&&d.close()}}}]);